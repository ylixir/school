\documentclass[11pt]{amsart}
%\documentclass[letterpaper]{article}

\usepackage{amsfonts,amssymb,amscd,amsmath,mathrsfs,amsthm,tikz}
\usepackage{forest}
\usepackage{cancel}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{gnuplottex}
\usepackage[utf8]{inputenc}

% Uncomment the following line in order to include graphics

%\usepackage[pdftex]{graphicx}

%
%  The following are margin definitions used in the publication at the end of term.
%

\setlength{\oddsidemargin}{0.25in}  %please do not change
\setlength{\evensidemargin}{0.25in} %please do not change
\setlength{\marginparwidth}{0in} %please do not change
\setlength{\marginparsep}{0in} %please do not change
\setlength{\marginparpush}{0in} %please do not change
\setlength{\topmargin}{0in} %please do not change

\setlength{\footskip}{.3in} %please do not change
\setlength{\textheight}{8.75in} %please do not change
\setlength{\textwidth}{6in} %please do not change
\setlength{\parskip}{4pt} %please do not change

\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{cor}{Corollary}
\newtheorem{fact}{Fact}
\newtheorem{exa}{Example}

\theoremstyle{definition}
\newtheorem{defi}{Definition}
%\renewcommand\qedsymbol{$\blacksquare$}

\titleformat{\section}{\centering\bfseries}{\thesection.}{.5em}{}
\titleformat{\subsection}{\centering\bfseries}{\thesubsection.}{.5em}{}
\titleformat{\title}{\centering}{\thesection.}{.5em}{}

\begin{document}

%\centerline{\bf{\LARGE{Sample Capstone Paper}}}
%\medskip
%\centerline{\large{by Math Student}}
%\bigskip
\title{On the Markov Basis}
\author{Jon Allen}
\begin{abstract}
In this article will study Markov bases, numerical semigroups and Gaussian
integers. We will study the relationship between these objects, and study  the
usefulness of maps between these objects.
\end{abstract}
\maketitle
\section{Introduction}
We will proceed by first going over some basic maps between elements of
$\mathbb{N}^n$ and monomials. We will also touch on similar maps from
$\mathbb{Z}^n$ and binomials.
%TM: What monomials? Binomials?

We will then touch on Markov bases and their relationships to the numerical
semigroups we will be looking at.

We will also look at what numeric semigroups are, along with the logic of their
construction. We will later use this information and logic to create a similar
construction with the Gaussian integers.

We will finally look the structure of the numerical semigroups and see a
surprising result in the Gaussian analogue of these.

\section{Numerical Semigroups}
We will go into a little greater depth here than we would ordinarily need to, but we will use some of this logic to make some decisions later when we examine Gaussian integers.

We begin with a set of unique positive integers $A=\{n_1,\dots,n_k\}$.
We can form an additive semigroup $S\subset \mathbb{Z}$ with elements of the
form $a_1n_1+\cdots+{a_k}n_k\in S$ where $a_i\in \mathbb{N}$. If $A=\{0\}$ then
our semigroup consists solely of the element $0$, which is not interesting.
Similarly if there exists some $n_i=0\in A$ then the semigroup formed by $A$ is
isomorphic to that formed by $A\setminus n_i$. In order to keep things simple we
will define $n_i\ne 0$ for all $1\le i\le k$.
%Further, if the cardinality of $A$ is 1, then $S\simeq\mathbb{N}$. This is also less than interesting.

Now if the elements of $A$ have a greatest common denominator $c\ne 1$ then
$c|s$ for every element $s\in S$. We can construct a semigroup $S'=\{a_1n_1/c+
\cdots+{a_k}{n_k}/c:a_i\in \mathbb{N},n_i\in A\}$ where $S\simeq S'$. So we see
that we can form a bijection between our $S$ semigroup and a semigroup with a
greatest common denominator of one by multiplying or dividing every element in
the group by $c$. Therefore we will only consider semigroups with coprime bases.


\begin{thm}
The complement of a semigroup in $\mathbb{N}$ generated by a set of positive
coprime integers is finite.
\begin{proof}
%TODO fix this proof
Now consider $n_i,n_j\in A$. Then $\{an_i+bn_j>0|a,b\in \mathbb{Z}\}=E$.
There is at least one element in this set ($z_i$) and so there is a smallest element. Let this smallest element be $c=az_i+bz_j$.
Now if we divide $z_i$ by $c$ then we obtain $z_i=cq+r$ with $0\le r<c$.
This leads to $r=z_i-cq=z_i-(az_i+bz_j)q=(1-aq)z_i+bqz_j\in E$. Now because $0\le r<c$ and $c$ is a minimal element then $r=0$. And so we have $z_i=cq$.
That is to say $c|z_i$. Similarly $c|z_j$ and so $c=1$.

Now if $1\in E\subseteq S$ then $a,b\ge0$ because the multiplication is just shorthand for the group addition. And so we have $1=az_i+bz_j$.
Now if $a,b\ge 0$ then either $z_i=1$ or $z_j=1$ or one of $z_i,z_j<0$. In any of these cases we have $S=\mathbb{Z}$ which is not interesting, and so we restrict $z_i$ to be in $\mathbb{N}$.
\end{proof}
\end{thm}
%TODO proper definition there
\begin{defi}\cite{rosales}
  A numerical semigroup is a nonempty subset $S$ of $\mathbb{N}$ that is closed
under addition, contains the zero element, and whose complement in $\mathbb{N}$
is finite.
\end{defi}

\subsection{Examples}
%TODO numerical semigroups
\begin{exa}
  The semigroup generated by $\{1\}$ is $\{0,1,2,\dots \}=\mathbb{N}$. Obviously
  $\mathbb{N}\setminus \mathbb{N}=\emptyset$ which is finite, thus $\mathbb{N}$
  is a numerical semigroup.
\end{exa}
\begin{exa}
  The semigroup generated by $\{2\}$ is $\{0,2,4,\dots \}$. The complement of
  this set is all odd natural numbers. The complement of this semigroup in
  $\mathbb{N}$ is not finite, thus our semigroup is not a numerical semigroup.
\end{exa}
\begin{exa}
  The semigroup generated by $\{2,3\}$ is $A=\{0,2,3,4,\dots \}$. Obviously
  $\mathbb{N}\setminus A=\{1\}$ which is finite, thus $A$ is a numerical
  semigroup.
\end{exa}
\begin{exa}
  The semigroup generated by $\{6,10,15\}$ is $B=\{0, 6, 10, 12, 15, 16, 18,
  20, 21, 22,\\ 24, 25, 26, 27, 28, 30, \dots \}$. Because $\mathbb{N}\setminus
  B=\{1,2,3,4,7,8,9,11,13,
  14,17,19,23,29\}$ which is finite, then $B$ is a numerical semigroup.
\end{exa}
\subsection{Frobenius Numbers}
The fact that numerical semigroups have a finite complement in $\mathbb{N}$ has
a consequence. Namely that for some semigroup $S$ there exists some minimal $N$
such that for $n\in S$ for every  $n>N$. This number is called the Frobenius
number.

We have a semigroup $S$ generated by the set of positive integers
$A=\{ n_1,\dots,n_k\}$. Let $n_\text{max}=\text{max}(\{n_1,\dots,n_k\})$ and
$n_{\min{}}=\min{\{n_1,\dots,n_k\}}$. If we choose some $s_1\in S$, then
there exists at least one $s_2$ such that $s_1<s_2\le s_2+n_{\max{}}$. In
fact, for any $n_i\in A,s_1\in S$ we know that
$s_1<s_1+n_i\le n_\text{max}$. This may seem obvious but let us continue.

This suggests a simple algorithm for finding a Frobenius number. Let us consider the numerical semigroup $\langle z_1,\dots,z_n\rangle$. We know that every numerical semigroup contains zero. Thus our first candidate for a Frobenius number is -1.

For this algorithm it will be convenient to work with the conductor, which is the Frobenius number plus one.
And so we have our first conductor candidate $c_1=0$.
At this point we have obviously accounted for every element in our semigroup smaller than our conductor candidate, and so we begin our algorithm by lettting $c_i=c_1$ and the set $F_i=\{c_i+z_1,\dots,c_i+z_n\}$.
It is good to know that $F_i$ has a maximum cardinality of $z_\text{max}$, which is all the numbers we will need to keep track of for this algorithm.

Now we start our algorithm.
Let us check the interval $[c_1+1,c_1+z_\text{min}]$.
If every element of this interval is contained in our set, then we have found our conductor $c_i$ and we are done.

Otherwise, we know that we have accounted for every member of our semigroup up to $\min F_i$. That means that we can make the smallest number of our set the new candidate for conductor, and then remove that number from our set. And so we take $c_{i+1}=\min F_i$. Now if we add our new candidate to every element in our semigroup basis and put it in the set, then we know that we will have generated every number in our semigroup up to the smallest element in our set. So let us make $F_{i+1}=F_i\setminus \{c_{i+1}\} + \{c_{i+1}+z_1,\dots c_{i+1}+z_n\}$. Now we set $i=i+1$ and go back to the beginning of the algorithm.

This algorithm will find the Frobenius number within a linear multiple of the number of elements in the semigroup and the size of the Frobenius number. There may be faster ways of finding this number, but for our purposes, it is simple to implement and works quickly enough.\cite{frobmask}.

\section{Bijections}
The things we need to understand is a common map that the literature takes for
granted. There is a straightforward map between $\mathbb{N}^n$ and monomials
over a field $k$. We choose some $\mathbf{\alpha}\in \mathbb{N}^n$ such that
$\mathbf{\alpha}=(\alpha_1,\dots,\alpha_n)$. Now we define a map for
$\varphi:\mathbb{N}^n\to k[x_1,\dots,x_n]$ such that $\mathbf{\alpha}\mapsto
\mathbf{x}^\alpha$.

Now we let $S=\langle n_1,\ldots,n_m\rangle$ be any numerical semigroup, and
$s\in S$ be an element of that semigroup, then $s=a_1n_1+\cdots+{a_m}n_m$. Of
course $(a_1,\ldots,a_m)\in \mathbb{N}^m$. Thus we have a very natural bijective
map between a numerical semigroup and a monomial.

\subsection{Numerical Semigroups in Lattice Theory}
\begin{defi}
\cite{stanley}
A \emph{lattice} is a partially ordered set in which every two elements have a
unique least upper bound and a unique greatest lower bound.
\end{defi}
\begin{exa}
$\mathbb{N}^2$ is a lattice with supremum and infinum for any two elements which
belong two it. Notice that $(1,2)$ and $(2,1)$ have a lower bound of $(1,1)$ and
an upper bound of $(2,2)$.
\end{exa}
\begin{exa}
We can form a lattice if we order $\mathbb{N}$ by division. The least common
multiple forms a least upper bound and an greatest lower bound is formed by the
greatest common denominator.
\end{exa}

\subsection{Smith Normal Form}
We first create a matrix $A$ such that the rows of $A$ correspond to the elements
of the Markov base. There exists two matrices $U,V$ and a diagonal matrix
\begin{defi}
  If we are given some matrix $A$ whose entries are in a principal ideal domain,
  then we can find some matrices $U,V,B$ such that
\[UAV=B=
\left[\begin{array}{cccc}
  a_1&\cdots&0\\
  \vdots&\ddots&\vdots \\
  0&\cdots&a_r&
\end{array}\right]
\text{ with }a_i|a_{i+1}\]
We call $B$ the \emph{Smith normal form} of $A$.\cite{adkins}
\end{defi}

\begin{exa}
  Let us find the Smith normal form of
  $
  A=\left[\begin{array}{rrr}
  3&-1&-1\\
  -1&2&-1\\
  -2&-1&2\\
  \end{array}\right]
  $. We start with $U'AV'=I_AAI_A$. We then use the standard row and column
  operations on $A$ while doing reflecting the row operations on $U'$ and the
  column operations on $V'$ to find our Smith normal form, along with the
  matrices which give us this form. Note that we are dealing with integers here,
  fractions are not allowed
  \begin{align*}
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  3&-1&-1\\
  -1&2&-1\\
  -2&-1&2\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&1\\
  \end{array}\right]\\
  &\Downarrow\\
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  1&1&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  3&-1&-1\\
  -1&2&-1\\
  0&0&0\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&1\\
  \end{array}\right]\\
  &\Downarrow\\
  \left[\begin{array}{rrr}
  1&2&0\\
  0&1&0\\
  1&1&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  1&3&-3\\
  -1&2&-1\\
  0&0&0\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&1\\
  \end{array}\right]\\
  &\Downarrow\\
  \left[\begin{array}{rrr}
  1&2&0\\
  1&3&0\\
  1&1&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  1&3&-3\\
  0&5&-4\\
  0&0&0\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&1\\
  \end{array}\right]\\
  &\Downarrow\\
  \left[\begin{array}{rrr}
  1&2&0\\
  1&3&0\\
  1&1&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  1&0&-3\\
  0&1&-4\\
  0&0&0\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&1&1\\
  \end{array}\right]\\
  &\Downarrow\\
  \left[\begin{array}{rrr}
  1&2&0\\
  1&3&0\\
  1&1&1\\
  \end{array}\right]
  &
  \left[\begin{array}{rrr}
  1&0&0\\
  0&1&0\\
  0&0&0\\
  \end{array}\right]
  \left[\begin{array}{rrr}
  1&0&3\\
  0&1&4\\
  0&1&5\\
  \end{array}\right]\\
\end{align*}
And so
$\left[\begin{array}{rrr} 1&2&0\\ 1&3&0\\ 1&1&1\\ \end{array}\right]
\left[\begin{array}{rrr} 3&-1&-1\\ -1&2&-1\\ -2&-1&2\\ \end{array}\right]
\left[\begin{array}{rrr} 1&0&3\\ 0&1&4\\ 0&1&5\\ \end{array}\right]
=\left[\begin{array}{rrr} 1&0&0\\0&1&0\\0&0&0 \end{array}\right]
$

\end{exa}
We can use the software package Xcas\cite{xcas} to easily compute these matrices.
\subsection{Markov Bases}
We indicated that there is a bijection between these semigroups and Markov
bases. We will discuss moving from a Markov basis to a numerical semigroup.
The last column of $V$ is a vector that is parallel and has the same magnitude as the
basis for our semigroup.

We can then use Theorem 1 to convert back to our Markov basis.

\section{Markov Bases}
%TM: Too abrupt
What are Markov bases? A definition of Markov basis follows\cite{bernd}.

\begin{defi}
Let $\mathcal{M}_A$ be the log-linear model associated with a matrix $A$ whose integer kernel we denote by $\ker_\mathbb{Z}(A)$.
A finite subset $\mathcal{B}\subset\ker_{\mathbb{Z}}(A)$ is a \emph{Markov basis} for $\mathcal{M}_A$ if for all $u\in \mathcal{T}(n)$ and all pairs $v,v'\in \mathcal{F}(u)$ there exists a sequence $u_1,\dots,u_L\in  \mathcal{B}$ such that
\[v'=v+\sum\limits_{k=1}^L{u_k}\text{ and }v+\sum\limits_{k=1}^l{u_k}\ge 0\text{ for all }l=1,\dots,L.\]
\end{defi}

The literature often refers to the elements of a Markov basis as \emph{moves}\cite[p.16]{bernd}

These bases are relevant because of the fundamental theorem of Markov bases which follows
\begin{thm}
\cite[p.~54]{aoki}
A finite set of moves $\mathcal{B}$ is a Markov basis for $A$ if and only if the set of binomials $\{p^{\mathbf{z}^+}-p^{\mathbf{z}^-}|\mathbf{z}\in \mathcal{B}\}$ generates the toric ideal $I_A$.
\end{thm}
\section{Gaussian Integers}

We can do the same thing with binomials.
In the binomial case we start with some $\mathbf{z}\in \mathbb{Z}^n$.
We define $\mathbf{z}=(z_1,\dots,z_n)$.
We also define $\mathbf{z}^+$ and $\mathbf{z}^-$ as follows:
\begin{align*}
  \mathbf{z}^+&=\mathbf{z}\vee\mathbf{0}&
  \mathbf{z}^-&=-(\mathbf{z}\wedge\mathbf{0})
\end{align*}
Now we can map an element of $\mathbb{Z}^n$ to the binomials over field $k$ if we define $\varphi:\mathbb{Z}^n\to k[x_1\dots x_n]$ as $\mathbf{z}\mapsto \mathbf{x}^{\mathbf{z}^+}-\mathbf{x}^{\mathbf{z}^-}$

Notice that the real and complex parts of Gaussian integers do not interact under addition. Now let us take the linear combination of some finite set of Gaussian integers.

If we do not restrict ourselves to positive coefficients, then we wind up with semigroups that span the entire number line along multiples of a greatest common denominator. This is as uninteresting now as it was with numerical semigroups, and so we will only look at positive values from here.

Now let us take some ``Gaussian semigroup'' $\mathbf{z}=\langle x_1+y_1i,\dots,
x_n+{y_n}i\rangle$ where $x_i,y_i\ge 0$. Notice that this semigroup is actually
just the direct sum of two numerical semigroups. Say $\mathbf{z}=\mathbf{x}\oplus\mathbf{y}=\langle x_1,\dots,x_n\rangle\oplus\langle y_1,\dots,y_n\rangle$.

Now as you may have guessed from our choice of notation, we are going to think of this direct sum as a Cartesian product. Now we know that the semigroup $\mathbf{x}$ has some Frobenius number after which every number is in the semigroup.

\begin{gnuplot}
set multiplot
set xrange [0:10]
set yrange [0:10]
set trange [0:10]
set parametric
plot 5,t; plot 6,t; plot 7,t; plot 8,t; plot 9,t; plot 10,t
\end{gnuplot}

And if we add in $\mathbf{y}$ then we have

\begin{gnuplot}
set multiplot
set xrange [0:10]
set yrange [0:10]
set trange [0:10]
set parametric
plot t,5; plot t,6; plot t,7; plot t,8; plot t,9; plot t,10
plot 5,t; plot 6,t; plot 7,t; plot 8,t; plot 9,t; plot 10,t
\end{gnuplot}


\bibliographystyle{amsplain}
\bibliography{bib}


\end{document}
